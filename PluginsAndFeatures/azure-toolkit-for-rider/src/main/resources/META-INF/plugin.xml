<idea-plugin xmlns:xi="http://www.w3.org/2001/XInclude" url="https://github.com/JetBrains/azure-tools-for-intellij">
  <id>com.intellij.resharper.azure</id>
  <name>Azure Toolkit for Rider</name>
  <vendor url="https://www.jetbrains.com">JetBrains</vendor>

  <xi:include href="/META-INF/azure-intellij-plugin-lib.xml" xpointer="xpointer(/idea-plugin/*)"/>
  <xi:include href="/META-INF/azure-intellij-plugin-service-explorer.xml" xpointer="xpointer(/idea-plugin/*)"/>
  <xi:include href="/META-INF/azure-intellij-plugin-arm.xml" xpointer="xpointer(/idea-plugin/*)"/>
  <xi:include href="/META-INF/azure-intellij-plugin-appservice-dotnet.xml" xpointer="xpointer(/idea-plugin/*)"/>

  <extensions defaultExtensionNs="com.microsoft.tooling.msservices.intellij.azure">
    <actions implementation="com.microsoft.azure.toolkit.intellij.common.action.LegacyIntellijAccountActionsContributor"/>
  </extensions>

  <resource-bundle>messages.RiderAzureMessages</resource-bundle>

  <depends>com.intellij.modules.rider</depends>
  <depends>com.intellij.database</depends>
  <depends>com.intellij.css</depends>
  <depends>com.jetbrains.restClient</depends>
  <depends>JavaScript</depends>

  <extensions defaultExtensionNs="com.intellij">
    <toolWindow
            anchor="left"
            factoryClass="com.microsoft.intellij.ui.ServerExplorerToolWindowFactory"
            id="Azure Explorer"
            canCloseContents="false"
            icon="/Common/Azure.svg"/>

    <applicationConfigurable parentId="tools"
                             id="com.microsoft.intellij.RiderAzureConfigurable"
                             provider="com.microsoft.intellij.AzureConfigurableProvider"/>

<!--    <applicationService serviceInterface="org.jetbrains.plugins.azure.storage.azurite.AzuriteService"-->
<!--                        serviceImplementation="org.jetbrains.plugins.azure.storage.azurite.AzuriteService"/>-->

<!--    <projectConfigurable groupId="tools"-->
<!--                         id="com.microsoft.intellij.configuration.AzureRiderConfigurable"-->
<!--                         provider="com.microsoft.intellij.configuration.AzureRiderConfigurableProvider"-->
<!--                         dynamic="true"/>-->


<!--    <projectConfigurable parentId="FileTemplatesSettingsId"-->
<!--                         instance="org.jetbrains.plugins.azure.functions.settings.templates.RiderAzureCSharpFileTemplatesOptionPage"-->
<!--                         groupWeight="-150" />-->

<!--    <projectConfigurable parentId="FileTemplatesSettingsId"-->
<!--                         instance="org.jetbrains.plugins.azure.functions.settings.templates.RiderAzureFSharpFileTemplatesOptionPage"-->
<!--                         groupWeight="-150" />-->

<!--    <configurationType implementation="com.microsoft.intellij.runner.webapp.config.RiderWebAppConfigurationType"/>-->
<!--    <programRunner implementation="com.microsoft.intellij.runner.webapp.config.RiderWebAppRunner"/>-->
<!--    <rider.publishConfigurationProvider implementation="com.microsoft.intellij.runner.webapp.WebAppContextPublishProvider" order="last" />-->

<!--    <configurationType implementation="com.microsoft.intellij.runner.functionapp.config.FunctionAppConfigurationType"/>-->
<!--    <programRunner implementation="com.microsoft.intellij.runner.functionapp.config.FunctionAppRunner"/>-->
<!--    <rider.publishConfigurationProvider implementation="com.microsoft.intellij.runner.functionapp.FunctionAppContextPublishProvider" order="last" />-->

<!--    <stepsBeforeRunProvider implementation="org.jetbrains.plugins.azure.functions.buildTasks.BuildFunctionsProjectBeforeRunTaskProvider"/>-->
<!--    <configurationType implementation="org.jetbrains.plugins.azure.functions.run.AzureFunctionsHostConfigurationType"/>-->
<!--    <runConfigurationProducer implementation="org.jetbrains.plugins.azure.functions.run.AzureFunctionsHostRunConfigurationProducer"/>-->

<!--    <registryKey key="azure.function_app.core_tools.feed.enabled"-->
<!--                 defaultValue="true"-->
<!--                 description="Enable downloading from Azure Functions Core Tools releases feed URL." />-->
<!--    <registryKey key="azure.function_app.core_tools.feed.url"-->
<!--                 defaultValue="https://functionscdn.azureedge.net/public/cli-feed-v4.json"-->
<!--                 description="Azure Functions Core Tools releases feed URL." />-->

<!--    <postStartupActivity implementation="com.microsoft.intellij.AzureRiderPlugin" />-->
<!--    <postStartupActivity implementation="org.jetbrains.icons.RiderIconsPatcherRegistrar"/>-->
<!--    <postStartupActivity implementation="org.jetbrains.plugins.azure.functions.TryRefreshAzureCoreToolsProjectTemplatesActivity" order="last" />-->
<!--    <postStartupActivity implementation="org.jetbrains.plugins.azure.functions.CleanupDeprecatedAzureCoreToolsConfigurationActivity" order="last" />-->

<!--    <projectTemplateProvider implementation="org.jetbrains.plugins.azure.functions.projectTemplating.FunctionsCoreToolsTemplatesProvider" order="first"/>-->

<!--    <fileTypeStatisticProvider implementation="org.jetbrains.plugins.azure.statistics.AzureFileTypeStatisticsProvider"/>-->

<!--    <projectService serviceImplementation="org.jetbrains.plugins.azure.cloudshell.CloudShellService" />-->

<!--    <rider.projectView.actions.projectTemplating.backend.reSharperProjectTemplateCustomizer implementation="org.jetbrains.plugins.azure.functions.projectTemplating.FunctionsCoreToolsTemplateCustomizer" />-->
<!--    <editorNotificationProvider implementation="org.jetbrains.plugins.azure.functions.AzureCoreToolsMissingNupkgNotificationProvider"/>-->

<!--    <localInspection language="MSBuild"-->
<!--                     enabledByDefault="true"-->
<!--                     level="WARNING"-->
<!--                     shortName="AzureFunctionsVersionNotSpecified"-->
<!--                     displayName="Azure Functions version not specified"-->
<!--                     groupName="Azure"-->
<!--                     implementationClass="org.jetbrains.plugins.azure.functions.codeInspection.msbuild.AzureFunctionsVersionInspection"/>-->

<!--    <internalFileTemplate name="Trigger Azure Function"/>-->

<!--    <completion.contributor language="C#"-->
<!--                            implementationClass="org.jetbrains.plugins.azure.functions.completion.csharp.TimerTriggerCompletionContributor" />-->

<!--    <serviceViewContributor implementation="org.jetbrains.plugins.azure.storage.azurite.AzuriteServiceViewContributor" />-->

<!--    <editorNotificationProvider implementation="org.jetbrains.plugins.azure.identity.ad.notifications.DefaultAzureAdApplicationRegistrationNotificationProvider"/>-->

<!--    <notificationGroup id="Azure" displayType="BALLOON" isLogByDefault="true"/>-->
<!--    <notificationGroup id="Azure Functions" displayType="BALLOON" isLogByDefault="true"/>-->
<!--    <notificationGroup id="Azure Web App Publish Message" displayType="BALLOON" isLogByDefault="true" toolWindowId="Run"/>-->
  </extensions>

<!--  <extensions defaultExtensionNs="com.microsoft.intellij">-->
<!--    <nodeActionsMap implementation="com.microsoft.intellij.serviceexplorer.RiderNodeActionsMap" />-->
<!--  </extensions>-->

  <applicationListeners>
    <listener class="com.microsoft.intellij.AzureActionsListener" topic="com.intellij.ide.AppLifecycleListener"/>
  </applicationListeners>

<!--  <project-components>-->
<!--    <component>-->
<!--      <implementation-class>org.jetbrains.plugins.azure.functions.daemon.FunctionAppDaemonHost</implementation-class>-->
<!--    </component>-->
<!--  </project-components>-->

  <actions>
    <action class="com.microsoft.intellij.actions.AzureExplorerOpenAction" id="Actions.AzureExplorerOpenAction"
            text="Show Azure Explorer" description="Show Azure Explorer" icon="/Common/Azure.svg"/>

    <action id="AzureToolkit.AzureSignIn" class="com.microsoft.azure.toolkit.intellij.common.auth.AzureSignInAction" text="Azure Sign In..." />
    <action id="AzureToolkit.SelectSubscriptions" class="com.microsoft.azure.toolkit.intellij.common.subscription.SelectSubscriptionsAction" text="Select Subscriptions..."
            description="ShowSubscriptionsAction" icon="AllIcons.General.Filter" />

    <group id="AzurePopupGroup" text="Azure" description="Azure" icon="/Common/Azure.svg" popup="true" class="com.microsoft.intellij.actions.AzurePopupGroup">
      <reference ref="AzureToolkit.ConnectToAzureResource"/>
    </group>

    <group id="AzureToolbarGroup" text="Azure" description="Azure">
      <reference ref="Actions.AzureExplorerOpenAction"/>
      <reference ref="AzureToolkit.OpenResourceConnectionExplorerAction"/>
    </group>

    <group id="AzureToolkit.AzureActionGroup"
           class="com.intellij.openapi.actionSystem.DefaultActionGroup"
           text="Azure"
           description="Contains Azure tools plugin actions"
           icon="/Common/Azure.svg"
           popup="true">
      <add-to-group group-id="ToolsMenu" anchor="first"/>
      <reference ref="AzureToolkit.SelectSubscriptions"/>
      <separator/>
      <reference ref="AzureToolkit.AzureSignIn"/>
    </group>
<!--    <action id="Actions.AzureCodeSamples"-->
<!--            class="com.microsoft.intellij.actions.AzureDotNetCodeSamples"-->
<!--            text="Azure Code Samples"-->
<!--            description="Opens an Azure Code Samples page in your default browser"-->
<!--            icon="CommonIcons.CodeSamples">-->
<!--      <add-to-group group-id="AzureToolbarGroup" anchor="after" relative-to-action="Actions.AzureExplorerOpenAction" />-->
<!--    </action>-->

<!--    <group id="RiderPublishToAzureGroup"-->
<!--           text="Publish Group"-->
<!--           description="Publish Group"-->
<!--           popup="true"-->
<!--           icon="CommonIcons.PublishAzure">-->
<!--      <add-to-group group-id="AzureToolbarGroup" anchor="first" />-->
<!--    </group>-->

<!--    &lt;!&ndash; Azure Cloud Shell &ndash;&gt;-->
<!--    <group id="AzureToolkit.AzureCloudShellGroup"-->
<!--           class="com.intellij.openapi.actionSystem.DefaultActionGroup"-->
<!--           text="Azure Cloud Shell"-->
<!--           description="Contains Azure Cloud Shell actions"-->
<!--           icon="CommonIcons.CloudShell.AzureOpenCloudShell">-->

<!--      <add-to-group group-id="AzureToolkit.AzureActionGroup"-->
<!--                    anchor="before"-->
<!--                    relative-to-action="AzureToolkit.AzureSignIn" />-->

<!--      <action id="AzureToolkit.StartAzureCloudShellAction"-->
<!--              class="org.jetbrains.plugins.azure.cloudshell.actions.StartAzureCloudShellAction"-->
<!--              text="Start Azure Cloud Shell..."-->
<!--              description="Start Azure Cloud Shell"-->
<!--              icon="CommonIcons.CloudShell.AzureOpenCloudShell" />-->

<!--      <action id="AzureToolkit.UploadToAzureCloudShellAction"-->
<!--              class="org.jetbrains.plugins.azure.cloudshell.actions.UploadToAzureCloudShellAction"-->
<!--              text="Upload file to Azure Cloud Shell..."-->
<!--              description="Upload file to Azure Cloud Shell"-->
<!--              icon="AllIcons.Actions.Upload" />-->

<!--      <group id="AzureToolkit.AzureCloudShell.WebPreview"-->
<!--             class="com.intellij.openapi.actionSystem.DefaultActionGroup"-->
<!--             text="Web preview"-->
<!--             description="Web preview"-->
<!--             popup="true">-->

<!--        <action id="AzureToolkit.AzureCloudShell.WebPreview.OpenPortAction"-->
<!--                class="org.jetbrains.plugins.azure.cloudshell.actions.OpenCloudShellPortAction"-->
<!--                text="Open port..."-->
<!--                description="Open web preview port..."-->
<!--                icon="AllIcons.Actions.Preview" />-->

<!--        <group id="AzureToolkit.AzureCloudShell.WebPreview.ClosePortAction"-->
<!--                class="org.jetbrains.plugins.azure.cloudshell.actions.CloseCloudShellPortActionGroup"-->
<!--                text="Close port"-->
<!--                description="Close web preview port..."-->
<!--                popup="true" />-->
<!--      </group>-->

<!--      <separator />-->
<!--    </group>-->

    <!-- Azure Storage / Azurite -->
<!--    <group id="AzureToolkit.AzuriteGroup"-->
<!--           class="com.intellij.openapi.actionSystem.DefaultActionGroup"-->
<!--           text="Azurite Storage Emulator"-->
<!--           description="Contains Azurite actions">-->

<!--      <add-to-group group-id="AzureToolkit.AzureActionGroup"-->
<!--                    anchor="before"-->
<!--                    relative-to-action="AzureToolkit.AzureSignIn" />-->

<!--      <action id="AzureToolkit.Azurite.StartAzurite"-->
<!--              class="org.jetbrains.plugins.azure.storage.azurite.actions.StartAzuriteAction"-->
<!--              text="Start Azurite"-->
<!--              description="Start Azurite Storage Emulator"-->
<!--              icon="AllIcons.Actions.Execute">-->
<!--      </action>-->

<!--      <action id="AzureToolkit.Azurite.StopAzurite"-->
<!--              class="org.jetbrains.plugins.azure.storage.azurite.actions.StopAzuriteAction"-->
<!--              text="Stop Azurite"-->
<!--              description="Stop Azurite Storage Emulator"-->
<!--              icon="AllIcons.Actions.Suspend">-->
<!--      </action>-->

<!--      <separator />-->
<!--    </group>-->

    <!-- Azure AD -->
<!--    <group id="AzureToolkit.AzureAdGroup"-->
<!--           class="com.intellij.openapi.actionSystem.DefaultActionGroup"-->
<!--           text="Azure Active Directory"-->
<!--           description="Contains Azure Active Directory actions">-->

<!--      <add-to-group group-id="ProjectViewPopupMenu" anchor="last" />-->
<!--      <add-to-group group-id="AzureToolkit.AzureActionGroup"-->
<!--                    anchor="before"-->
<!--                    relative-to-action="AzureToolkit.AzureSignIn" />-->

<!--      <action id="AzureToolkit.AzureAd.RegisterApplication"-->
<!--              class="org.jetbrains.plugins.azure.identity.ad.actions.RegisterApplicationInAzureAdAction"-->
<!--              text="Register Azure AD application"-->
<!--              description="Register application in Azure Active Directory"-->
<!--              icon="CommonIcons.AzureActiveDirectory">-->
<!--      </action>-->

<!--      <separator />-->
<!--    </group>-->
  </actions>
</idea-plugin>
